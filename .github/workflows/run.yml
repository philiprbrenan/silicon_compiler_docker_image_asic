# Test 2025-11-16 at 01:42:01
name: Build and Push Docker Image
run-name: silicon_compiler_docker_image_asic

on:
  push:
    paths:
      - .github/workflows/run.yml

jobs:

  step0:
    name: Base
    runs-on: ubuntu-latest
    
    steps:

      - name: Checkout repo silicon_compiler_docker_image_asic
        uses: actions/checkout@v3


      - name: Log in to GitHub Container Registry
        uses: docker/login-action@v2
        with:
          registry: ghcr.io
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}


      - name: Build step 0
        uses: docker/build-push-action@v4
        with:
          context: steps
          file: steps/0.txt
          push: true
          tags: ghcr.io/philiprbrenan/silicon_compiler_docker_image_asic:0

  step1:
    name: openroad
    runs-on: ubuntu-latest
    needs: step0
    steps:

      - name: Checkout repo silicon_compiler_docker_image_asic
        uses: actions/checkout@v3


      - name: Log in to GitHub Container Registry
        uses: docker/login-action@v2
        with:
          registry: ghcr.io
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}


      - name: Build step 1
        uses: docker/build-push-action@v4
        with:
          context: steps
          file: steps/1.txt
          push: true
          tags: ghcr.io/philiprbrenan/silicon_compiler_docker_image_asic:1

  step2:
    name: klayout
    runs-on: ubuntu-latest
    needs: step1
    steps:

      - name: Checkout repo silicon_compiler_docker_image_asic
        uses: actions/checkout@v3


      - name: Log in to GitHub Container Registry
        uses: docker/login-action@v2
        with:
          registry: ghcr.io
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}


      - name: Build step 2
        uses: docker/build-push-action@v4
        with:
          context: steps
          file: steps/2.txt
          push: true
          tags: ghcr.io/philiprbrenan/silicon_compiler_docker_image_asic:2

  step3:
    name: yosys
    runs-on: ubuntu-latest
    needs: step2
    steps:

      - name: Checkout repo silicon_compiler_docker_image_asic
        uses: actions/checkout@v3


      - name: Log in to GitHub Container Registry
        uses: docker/login-action@v2
        with:
          registry: ghcr.io
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}


      - name: Build step 3
        uses: docker/build-push-action@v4
        with:
          context: steps
          file: steps/3.txt
          push: true
          tags: ghcr.io/philiprbrenan/silicon_compiler_docker_image_asic:3

  step4:
    name: sv2v
    runs-on: ubuntu-latest
    needs: step3
    steps:

      - name: Checkout repo silicon_compiler_docker_image_asic
        uses: actions/checkout@v3


      - name: Log in to GitHub Container Registry
        uses: docker/login-action@v2
        with:
          registry: ghcr.io
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}


      - name: Build step 4
        uses: docker/build-push-action@v4
        with:
          context: steps
          file: steps/4.txt
          push: true
          tags: ghcr.io/philiprbrenan/silicon_compiler_docker_image_asic:4

  step5:
    name: yosys-slang
    runs-on: ubuntu-latest
    needs: step4
    steps:

      - name: Checkout repo silicon_compiler_docker_image_asic
        uses: actions/checkout@v3


      - name: Log in to GitHub Container Registry
        uses: docker/login-action@v2
        with:
          registry: ghcr.io
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}


      - name: Build step 5
        uses: docker/build-push-action@v4
        with:
          context: steps
          file: steps/5.txt
          push: true
          tags: ghcr.io/philiprbrenan/silicon_compiler_docker_image_asic:latest
